from Crypto.Util.number import *
import gmpy2


def solve_ctf(e, n, dp, c):
    """
    解题函数：利用dp泄漏攻击解密RSA
    """
    # 枚举k从1到e-1
    for k in range(2, e):
        if (e * dp - 1) % k == 0:
            p = (e * dp - 1) // k + 1
            if n % p == 0:
                # 找到p，计算q
                q = n // p

                # 计算φ(n)
                phi = (p - 1) * (q - 1)

                # 计算私钥d
                d = gmpy2.invert(e, phi)

                # 解密得到m
                m = pow(c, d, n)

                # 将m转换为字符串
                flag = long_to_bytes(m).decode()
                return flag
    return None


e = 65537
n = 98523589166698215884772678597126381330729042409867906419776228376328394083113113810566361681776383135721618320266085382467318657506884467970213696370301053102178834366258554086282183236507513622996917266419984601116179992149604378946213411633778008170053460579973392211434938839020605646327849068116301554053
dp = 5138636274856700080941828013807156958082237286853007924695738133342859363355437998008259170260315338728640155874737284930133190696925369174593997368399761
c = 81387127961421902230857210411279023161773956760695301546933898924006410439044243629343875994387728788391446830661374802652363868007527718797900701113897594566288568833319705717842048295047236231759241072305294457689433087267810684045886576363621162635358100858319636959737626031693142150135828215563162557116

flag = solve_ctf(e, n, dp, c)
print(f"解密结果: {flag}")